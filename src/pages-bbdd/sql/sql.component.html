<app-header-print [data]="headerPrintData"></app-header-print>

<main>
  <h1 class="title">SQL</h1>

  <section>
    <h2>Introducción</h2>

    <p>
      Para empezar, SQL son las siglas de <strong>Structured Query Language</strong>, que en español significa
      <i>Lenguaje de consultas estructurado</i>. Es un lenguaje y sirve para realizar consultas a bases de datos
      relacionales. Resumiéndolo mucho una base de datos relacional son varias tablas relacionadas entre sí, con sus
      filas y sus columnas.
    </p>

    <p>
      Este lenguaje es un estándar, por lo que pueden existir diferentes implementaciones o también llamados dialectos
      que pueden diferir entre sí con elementos que no están en el estándar. Ejemplos son las implementaciones de
      Oracle, Microsoft, MySQL o PostgreSQL.
    </p>

    <p>
      Como todo lenguaje tiene su sintaxis y sus palabras reservadas, y es lo que vamos a ver a continuación. Vamos
      derecho a ello.
    </p>
  </section>

  <section>
    <h2>Entorno</h2>

    <p>
      Para poder practicar necesitamos tener algún programa instalado que nos permita crear bases de datos y realizar
      consultas. En mi caso voy a usar MySql, que es un sistema de gestión de bases de datos relacional con licencia
      dual, es decir, tiene una parte libre y otra comercial. Si tienes curiosidad investiga lo que significa, yo
      tampoco lo sabía.
    </p>

    <p>
      Como sistema operativo usaré Ubuntu. Es muy sencillo de instalar, así que por aquí dejo los comandos. Por cierto,
      lo he hecho como usuario root.
    </p>

    <app-terminal-code>
      <p terminal-code-command>apt-get update</p>
      <p terminal-code-command>apt-get install mysql-server</p>
      <p terminal-code-command>mysql --version</p>
      <p terminal-code-output>mysql Ver 8.0.32-0ubuntu0.20.04.2 for Linux on x86_64 ((Ubuntu))</p>
    </app-terminal-code>

    <p>Estando instalado, para conectarnos con una terminal donde aprender sql tenemos este comando:</p>

    <app-terminal-code>
      <p terminal-code-command>
        mysql -h &lt;dominio-o-direccionIP&gt; -u &lt;usuario&gt; -p&lt;password&gt;
        &lt;nombreBaseDeDatos&gt;
      </p>
    </app-terminal-code>

    <p>
      En mi caso el dominio es localhost, así que lo omito. Fíjate que la contraseña tiene que ir pegada al parámetro
      -p. Si pones un espacio no te la tomará y te pedirá la contraseña al pulsar intro. El nombre de la base de datos
      también es opcional. Como aún no tenemos ninguna, no lo pongo.
    </p>

    <app-terminal-code>
      <p terminal-code-command>mysql -u root -p</p>
      <p terminal-code-output>Enter password:</p>
      <p terminal-code-output>mysql></p>
    </app-terminal-code>
  </section>

  <section>
    <h2>Crear una base de datos</h2>

    <p>
      Para empezar a trabajar lo primero que tenemos que tener o crear es la base de datos. En este artículo vamos a
      crear una base de datos para un negocio de coches ficticio. Esto es sencillo de hacer:
    </p>

    <app-terminal-code>
      <p terminal-code-command>create database business;</p>
      <p terminal-code-output>Query OK, 1 row affected (0,00 sec)</p>
    </app-terminal-code>

    <p>
      Ya esta creada la base de datos. La he llamado <i>business</i>. Lo único que no tiene tablas ni información.
      Podemos ver las bases de datos que tenemos con:
    </p>

    <app-terminal-code>
      <p terminal-code-command>show databases;</p>
      <pre terminal-code-output>+--------------------+
| Database           |
+--------------------+
| business           |
| information_schema |
| mysql              |
| performance_schema |
| sys                |
+--------------------+
5 rows in set (0,00 sec)</pre>
    </app-terminal-code>

    <p>
      Vemos que nuestra base de datos está ahí. Las otras son cosas del servidor y contienen metainformación. Mejor no
      tocarlas.
    </p>

    <p>
      Para trabajar con la base de datos creada, la debemos seleccionar. De esta forma los comandos que escribamos irán
      por defecto dirigidos a ella.
    </p>

    <app-terminal-code>
      <p terminal-code-command>use business;</p>
      <p terminal-code-output>Database changed</p>
    </app-terminal-code>
  </section>

  <section>
    <h2>La sentencia SELECT</h2>

    <p>
      Esta es la sentencia básica para recuperar datos de una base de datos. El formato de una consulta con esta
      sentencia es:
    </p>

    <code>
      <pre class="select-sintax">SELECT [ALL | DISTINCT]
expresión
FROM tabla
WHERE condición
ORDER BY columna/nº columna [ASC | DESC]</pre>
    </code>

    <p>
      La salida del comando es otra tabla con tantas filas como filas de la tabla a consultar cumplan la condición y
      tantas columnas como expresiones indiquemos.
    </p>

    <p>
      Con la primera línea indicamos que vamos a seleccionar datos de la tabla. La opción ALL es por defecto y significa
      que seleccione todas las filas aunque estén repetidas. Si ponemos DISTINCT la tabla de salida solo tendrá filas
      que no están repetidas (se eliminan las que están duplicadas).
    </p>

    <p>
      La segunda línea es una expresión. Podemos poner varias separadas por comas. Consiste en el nombre de una columna
      de la tabla, o expresiones matemáticas, o llamadas a funciones que manejen datos de tipo fecha o numérico o
      string. Podemos hacer que se concatenen columnas en una sola, y muchas más cosas.
    </p>

    <p>
      Con FROM indicamos la tabla de la cual vamos a seleccionar datos.
    </p>

    <p>
      Con WHERE podemos indicar las condiciones para seleccionar filas de la tabla. Podemos usar operadores lógicos
      (AND, OR y NOT), de comparación (=, &lt;&gt;, &lt;, &lt;=, &gt;,&gt;=) o predicados más avanzados (IN, BETWEEN,
      LIKE, IS NULL)
    </p>

    <p>
      Con ORDER BY podemos ordenar las filas de la tabla resultante de forma ascendente o descendente. Podemos hacerlo
      indicando el índice de una columna o su nombre. El nombre de la columna es el de la tabla original, o si es una
      columna compuesta (una expresión más compleja) podemos poner AS en la expresión para ponerle un nombre a la
      columna resultante.
    </p>

    <p>
      Veámosla en uso. Supongamos que tenemos la siguiente tabla (llamada <i>Car</i>) con información sobre coches:
    </p>

    <div class="car-table">
      <table>
        <thead>
          <tr>
            <td>ID</td>
            <td>MARCA</td>
            <td>NOMBRE</td>
            <td>MATRICULA</td>
            <td>COMBUSTIBLE</td>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let car of carsTable">
            <td>{{car.id}}</td>
            <td>{{car.brand}}</td>
            <td>{{car.name}}</td>
            <td>{{car.registration}}</td>
            <td>{{car.propulsion}}</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p>
      Ahora vamos a realizar algunas consultas. Por ejemplo, busquemos los coches que su combustible es diésel. La
      consulta y el resultado serían estos:
    </p>

    <code class="comand-example">
      <div>
        <pre><span class="command">SELECT * FROM Car WHERE COMBUSTIBLE="Diésel";</span>
+----+---------+--------+-----------+-------------+
| ID | MARCA   | NOMBRE | MATRICULA | COMBUSTIBLE |
+----+---------+--------+-----------+-------------+
|  0 | Renault | Megane | 0012TER   | Diésel      |
|  1 | Seat    | León   | 8435POM   | Diésel      |
|  3 | Ford    | Focus  | 1493UGF   | Diésel      |
|  6 | Seat    | Arona  | 7591MIN   | Diésel      |
|  8 | Audi    | A3     | 1254UNR   | Diésel      |
+----+---------+--------+-----------+-------------+</pre>
      </div>
    </code>

    <!-- TODO continue with more examples -->
  </section>
</main>